---
- name: Copy pacman configuration file
  template: src=pacman.conf.j2 dest=/etc/pacman.conf

- name: Full system upgrade
  pacman:
    update_cache: yes
    upgrade: yes

- name: Install shells
  include_tasks: shell.yml

- name: Install packages
  include_tasks: packages.yml

- name: Setup sudo
  include_tasks: sudo.yml

- name: Install Power management
  package: name={{ item }} state=present
  with_items:
    - acpid
    - acpi
    - powertop
  tags:
    - power

- name: Enable ACPID
  service: name=acpid.service enabled=yes
  tags:
    - power

- name: Enable fstrim for ssd
  service: name=fstrim.timer enabled=yes

- name: Install smartmontools
  pacman: name=smartmontools state=present

- name: Install Intel microcode
  pacman: name=intel-ucode state=present
  when: '"GenuineIntel" in ansible_processor'
