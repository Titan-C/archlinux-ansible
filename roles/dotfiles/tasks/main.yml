---
- name: Create main user
  user: name={{ user.name }} state=present create_home=yes

- name: Clone user dotfiles
  git:
    repo: "{{ dotfiles.url }}"
    dest: /home/{{ user.name }}/{{ dotfiles.destination }} accept_hostkey=yes
    update: no
  when: dotfiles is defined
  become: yes
  become_user: "{{ user.name }}"

- name: Clone oh-my-zsh repo
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git
    dest: /home/{{ user.name }}/.oh-my-zsh
  become: yes
  become_user: "{{ user.name }}"

