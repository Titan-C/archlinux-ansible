---
- hosts:
    - backup
    - nina
  user: orchest
  become: True
  roles:
    - { role: base, tags: ["base"] }
    - { role: cron, tags: ["cron"] }
    - { role: networking, tags: ["networking"] }
    - { role: ssh, tags: ["ssh"] }
    - { role: monitoring, tags: ["monitoring"] }

- hosts: backup
  user: orchest
  become: True
  roles:
    - {
        role: bitcoin,
        tags: ["bitcoin"],
        networks:
          [
            { name: "bitcoin", datadir: "/var/lib/bitcoind/", extra_args: "" },
            {
              name: "regtest",
              datadir: "/var/lib/bitcoind/",
              extra_args: "-regtest",
            },
          ],
      }

- hosts: nina
  user: orchest
  become: True
  roles:
    - {
        role: postgresql,
        tags: ["postgres"],
        postgres_tls_method: "self-signed",
      }
    - {
        role: cardano,
        tags: ["cardano"],
        dbs: ["mainnet", "preview"],
        networks:
          [
            { desc: "Mainnet", name: "mainnet", port: "3001" },
            { desc: "preview", name: "preview", port: "3002" },
          ],
        # postgres_host: "db.arsmagna.xyz",
        cardano_db_pwd: "{{ lookup( 'password', 'pass/pgsql_cardano.pwd' ) }}",
      }
